# 大数据问题

### 赛马问题：

25匹马，速度都不同，但每匹马的速度都是定值。现在只有5条赛道，无法计时，即每赛一场最多只能知道5匹马的相对快慢。问最少赛几场可以找出25匹马中速度最快的前3名？

每五匹马一个分组，结果为

|      | 1    | 2    | 3    | 4    | 5    |
| ---- | ---- | ---- | ---- | ---- | ---- |
| A    | A1   | A2   | A3   |      |      |
| B    | B1   | B2   | B3   |      |      |
| C    | C1   | C2   | C3   |      |      |
| D    | D1   | D2   | D3   |      |      |
| E    | E1   | E2   | E3   |      |      |



赛完五场之后知道每组的排序，为A1、A2等，然后挑选每组冠军赛第6场，挑选出冠军为A1，因为B1大于C D E 组，C1大于D E组，还剩下两个名额，则D E组直接被淘汰，剩下两名只有可能在A2 A3  B1 B2 C1 中挑选，则只需要进行第七场比赛就可以了。



### 赛马问题改进版

64匹马，8个赛道，找出最快的4匹马。4个赛道怎么解决？

|      | 1    | 2    | 3    | 4    | 5    |      |      |      |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| A    | A1   | A2   | A3   | A4   |      |      |      |      |
| B    | B1   | B2   | B3   | B4   |      |      |      |      |
| C    | C1   | C2   | C3   | C4   |      |      |      |      |
| D    | D1   | D2   | D3   | D4   |      |      |      |      |
| E    |      |      |      |      |      |      |      |      |
| F    |      |      |      |      |      |      |      |      |
| G    |      |      |      |      |      |      |      |      |
| H    |      |      |      |      |      |      |      |      |

先赛完八场，找出每场中最快的马进行排序，然后对最快的8皮马进行一次比赛，挑选出最快的一匹为A1，则剩下四匹马在A2 A3 A4      B1 B2 B3     C1 C2      D1 中挑选

|      | 1    | 2    | 3    | 4    |      |      |      |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| A    | A2   | A3   | A4   |      |      |      |      |
| B    | B1   | B2   | B3   |      |      |      |      |
| C    | C1   | C2   |      |      |      |      |      |
| D    | D1   |      |      |      |      |      |      |
|      |      |      |      |      |      |      |      |
|      |      |      |      |      |      |      |      |
|      |      |      |      |      |      |      |      |

则在A2 B1 C1 D1  A3 B2 C2 A4进行比赛，赛第10场，确定前三名，若前三名中不包含B2，则比赛结束，如前三名中包含B2 则还需要将前三名和B3进行比赛，赛11场



### 赛马问题概率问题

在一条无限长的跑道上，有N匹马在不同的位置上出发开始赛马。当开始赛马比赛后，所有的马开始以自己的速度一直匀速前进。每匹马的速度都不一样，且全部是同样的均匀随机分布。在比赛中当某匹马追上了前面的某匹马时，被追上的马就出局。 请问按以上的规则比赛无限长的时间后，赛道上剩余的马匹数量的数学期望是多少？

解决方案：假设N匹马的速度为A1 A2 A3 A4，

A1：速度最快，永远不会出局

A2：速度第二快，必须在A1后面才可以存活，概率为1/2

A3：速度第三块，必须在A2后面才可以活下来，要不然后背追上，概率为1/3

期望是1 + 1/2 + 1/3 +....... 1/N



### TOPN问题

在系统中，将大量的对象进行排序，然后取出最TOP的前N名作为排行榜的数据。



基于有序数组的筛选法

思路：使用一个长度为N的数组，来存放最TOP的N个对象，越TOP的对象其在数组中的index就越小。每次加入一个对象时，就与index最大的那个对象进行比较，在取到前N个数字时，长度为N的数组就满了，对于后面的数字，如该数字小于等于index最大的那个数字，则不管，若该数字大于index最大的那个数字，则抛弃数组中index最大的数字，将该数组添加进行数组最后一位，并分别将该数字与前一位数字比较，若不满足排序关系，则交换。如此，可以保证容器中始终保持的都是最Top的N个对象。

算法复杂度：M*N





基于小根堆的筛选法。

思路：使用大小为 n 的小根堆保存结果集，最小项为堆的根节点 ptop[0],遍历 pdata 中，如果当前数据大于ptop[0],并把数据替换根节点，并对根节点 SiftDown 操作，保持结果集仍然为小根堆。算法复杂度，只有 m∗log2



### M个数组中topN问题



M个排好顺序的数组，每个数组长度为F，找出所有前N大的数。

解决方法：建立一个大根堆，大小为M个，这,个元素为M个数组中每个元素的最大值。

每次从M个堆中拿出最大的数字，从M个数中选取最大的一个数放入N长度的数组中，直至数组放满为止。



